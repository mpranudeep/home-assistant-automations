define(['exports', 'preact/jsx-runtime', 'preact/hooks', './Layer-ba294014', 'preact/compat', './TopLayerHost-04f78157', './Modal-95577f1e', './FocusTrap-f2f3e77b', './tabbableUtils-3f4506c3', './positionUtils-fe1f7954', './clientHints-dbd4357f', './useOutsideClick-0c12462c', './useAnimation-bdc8e7f7', './useUser-1cf184a1', './useTestId-26d55a32', './useSwipe-0a7c8482', './useComponentTheme-b44c0028', './colors-a7470a58', './mergeInterpolations-e7e2a709', './UNSAFE_DrawerPopup/themes/redwood/DrawerPopupTheme', './useThemeInterpolations-e7364c0d', './useColorScheme-dc114593', './useScale-dbe3a08d', './theme-b5b2260c', './Theme-2dc8b6f4', 'preact', './Common/themes/redwood/theme', './Common/themes/themeContract.css', './UNSAFE_Modal/themes/ModalStyles.css', 'css!./ModalStyles.styles.css', './vanilla-extract-recipes-createRuntimeFn.esm-0883d6a2', './FocusTracker-ec848ce2', './classNames-60f91d93', './PRIVATE_FocusTracker/themes/FocusTrackerStyles.css', 'css!./FocusTrackerStyles.styles.css', './head-44f0c95b', './_arity-c8c764a8', './_curry3-a7927ef7', './_curry1-29759c0d', './_curry2-3c2a6ddd', './_isArray-e1950e46', './_isString-5a1a6795', './arrayUtils-acfed3bd', './logger-87202d60', './_isObject-30730c61', './UNSAFE_DrawerPopup/themes/redwood/DrawerPopupBaseTheme.css', 'module', './UNSAFE_DrawerPopup/themes/DrawerPopupStyles.css', 'css!./DrawerPopupStyles.styles.css', './UNSAFE_DrawerPopup/themes/redwood/DrawerPopupVariants.css', 'css!./DrawerPopupVariants.styles.css'], (function(e,t,s,r,o,a,n,i,c,l,u,d,p,m,f,b,h,y,w,g,v,S,P,T,D,E,C,F,k,_,A,x,O,U,M,R,I,j,N,H,L,X,Y,z,B,V,W,$,K,q,G){"use strict";const J="0px",Q=250;e.DrawerPopup=({children:e,isOpen:o=!1,autoFocusRef:a,placement:v="start",modality:S="modal",onClose:P,onTransitionEnd:T,"aria-label":D,"aria-labelledby":E,"aria-describedby":C,testId:F,...k})=>{const[_,A]=s.useState(o?"initial":"unmounted"),[x,O]=s.useState("hidden"),[U,M]=s.useState(!o),[R,I]=s.useState("overlay"),j=s.useRef(null),N=s.useRef(null),H="bottom"===v,L={opening:()=>H?{from:{translateY:B()},to:{translateY:J},options:{duration:Q}}:{from:{translateX:z()},to:{translateX:J},options:{duration:Q}},closing:()=>H?{from:{translateY:J},to:{translateY:B()},options:{duration:Q}}:{from:{translateX:J},to:{translateX:z()},options:{duration:Q}}},X=f.useTestId(F),{direction:Y}=m.useUser(),z=()=>{return`${"right"===l.normalizePosition(v,Y)?"":"-"}${e=j.current,Math.round(e.getBoundingClientRect().width)}px`;var e},B=()=>{return`${e=j.current,Math.round(e.offsetHeight)}px`;var e},{nodeRef:V}=p.useAnimation(_,{animationStates:L,isAnimatedOnMount:!0,onAnimationEnd:()=>{"opening"===_?T?.(!0):o||(V(null),O("hidden"),A("unmounted"),T?.(!1))}});s.useEffect((()=>{if("unmounted"!==_||o){if("unmounted"!==_||!o)return"initial"===_&&o?(V(j.current),M(!1),void A("opening")):void("opening"===_&&o?O("visible"):o||(M(!0),A("closing")));A("initial")}}),[o,_,V]),s.useEffect((()=>{if("opening"===_){const e=c.getActiveElement();N.current=e===document.body?document.body:e,N.current?.addEventListener("keydown",W)}if("closing"===_)return()=>{N.current?.removeEventListener("keydown",W)}}),[_]);const W=e=>{N.current===c.getActiveElement()&&"F6"===e.code&&(e.preventDefault(),e.stopPropagation(),c.focusWithin(j.current))},$=s.useCallback((e=>{const t=N.current;switch(e.code){case"Escape":P?.({reason:"escapeKey"});break;case"F6":e.preventDefault(),e.stopPropagation(),t&&c.focusOn(t)}}),[P]),K=s.useCallback((()=>{P?.({reason:"outsideClick"})}),[P]);d.useOutsideClick({isDisabled:U,ref:j,handler:K});const q=u.getClientHints(),G=s.useCallback((()=>"ios"===q.platform?document.documentElement.clientWidth:window.innerWidth),[q.platform]),Z=s.useCallback((()=>{const e=G();"overlay"===R&&e<600&&I("fullOverlay"),"fullOverlay"===R&&e>600&&I("overlay")}),[G,R]);s.useEffect((()=>{if(j.current&&"opening"===_){const e=new ResizeObserver((()=>{Z()}));return e.observe(document.body),()=>{e.unobserve(document.body)}}}),[_,Z]);const ee=s.useCallback((e=>{const t=e.direction;("ltr"===Y&&"start"===v&&"left"===t||"end"===v&&"right"===t||"rtl"===Y&&"start"===v&&"right"===t||"end"===v&&"left"===t||"bottom"===v&&"down"===t)&&P?.({reason:"swipe"})}),[Y,v,P]),{swipeProps:te}=b.useSwipe(ee,{threshold:50,maximumTime:750,tolerance:40}),{classes:se}=h.useComponentTheme(g.DrawerPopupRedwoodTheme,{placement:H?v:"rtl"===Y?"start"===v?"right":"left":"start"===v?"left":"right",visibility:x,displayModeHorizontal:["start","end"].indexOf(v)>-1?R:void 0}),re=[...Object.values(y.colorInterpolations)],oe=w.mergeInterpolations(re),{...ae}=oe(k),ne=()=>t.jsx("div",{ref:j,className:se,style:ae,tabIndex:-1,role:"dialog",onKeyDown:$,"aria-label":D,"aria-labelledby":E,"aria-describedby":C,...te,...X,children:t.jsx(i.FocusTrap,{autoFocusRef:a,children:e})}),ie="unmounted"!==_;return ie?"modal"===S?t.jsx(n.Modal,{isOpen:ie,children:ne()}):t.jsx(r.Layer,{children:ne()}):null},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=UNSAFE_DrawerPopup.js.map
